# POWER [CRYPTO]

Öncelikle soru gerçek hayattan uzak, kalitesi tartışılabilir, tam olarak kategorisi ise `Stego&Crypto + Tahmin` ağırlıklı  ve son 2-3 saat kala gelen bi soruya göre çözülmek için biraz gazete pazar eki bulmacası tadında. 

Soru: 
 Bize bir [POWER.zip](https://raw.githubusercontent.com/ozancetin/CTF-Writeups/master/2019/STMCTF2019/POWER/POWER.zip)
 dosyası verilmiş. İçerisinde power.jpg ve soru.txt mevcut

Soru.txt :

```
RSA decryption sırasında CPU'nun harcadığı gücü yan kanal analizi ile ölçtük. Sonuçlar power.jpg'de.

c =
6989948518232384864776638814859831591901837611907564903634405279896177437836827945714748614888983988728637485614070870977180774832773899224982914219277551793975090942823743973796811784289974047801705426989528230917131553686987581588091533315187245746656484375900794753350613814764158557562323887200250573252180097909170473172195491291928129134980077422551100499336853912674636732929441216424149814296320827970989924149481811607226528197449647871111226798077417180876925544299697444446643855793213707552379877215861130808560692690231253480548958307798400899147718220394516058861876909981592273632212374753442396382822

e = 65537

n =   24554082244423576690279633247865769176171558470735704642013748456293986193768290232671815437132451174934519049784696027147781044695306925702057388654404061134243359186055889332417446146289789929503311347508856172482634852836123428376583619524965874497204667755767688503035506095489672593674965956038947918754161997820726040674864658744822975386315296832923061518481651545615396827420722325276534476848101960733475080768574205931138886447888957784368331413187068740663339419123762654261526051955619178483106487893708893917779677273100451964193513643587668371074516605372011468635189674135998949600383546855684675027489

```

power.jpg:

![](https://github.com/ozancetin/CTF-Writeups/blob/master/2019/STMCTF2019/POWER/power.jpg?raw=true)


power.jpg'e Steghide bruteforce attığımda içinden [power.jpg.out](https://github.com/ozancetin/CTF-Writeups/blob/master/2019/STMCTF2019/POWER/power.jpg.out)
 veri seti çıktı.

Steghide bruteforce için github reposu: https://github.com/Paradoxis/StegCracker

Parolayı tam olarak bilmiyorum fakat rockyou wordlistinde çok üstte olan basit bir ve hızlı kırılabilen parolaya sahip.



Her neyse veriler, Soruya göre CPU'nun harcadığı gücün grafiğine ait. 
Verileri detaylı incelediğimde en yüksek 800 bandı, düşüklük olarak 400 bandı, ve en düşük 100 bandında 3 çeşit veri bulunuyor.

![](https://raw.githubusercontent.com/ozancetin/CTF-Writeups/master/2019/STMCTF2019/POWER/1.png)


Sıklıklara baktığımda 100 bandıdaki veriler cpunun normal halini temsil ediyor olabilir. belirgin olarak 400 ve 800 bandındaki veriler daha düzensiz ve hesaplama adına anlamlı veriler gibi görünüyor (çok şeyapmayın deneme yanılma)

`Her 100lü veriyi silip`

`Her 400lü veriye  > 0 `

`Her 800lü veriye  > 1 `

verdiğim zaman veriler biraz daha anlamlı olmaya başlıyor. her ne kadar rsa için tahminli bir aşama olsa da sabırla devam ediyorum.

bu seyreltme işini SublimeText ve Regex kullanarak yaptım:

son çıkan manzara böyleydi:

![](https://raw.githubusercontent.com/ozancetin/CTF-Writeups/master/2019/STMCTF2019/POWER/2.png)


10ar 10ar çıkan 0 ve 1 leride seyrelttim:

`0 0 0 0 0 0 0 0 0 0 > 0`

`1 1 1 1 1 1 1 1 1 1 > 1`

ve en son elimizde kalan binary verisi:

``1110001001010011000011001101000110011010100011111101111100100101000010101100000001001111100110101101001001010000111111001100100110111111111000001001001011111101001100011101011101001111110010000011010010001111011111111000111010111101001100010001000010111000110010001001111000100100111010110100010100110111001000011001110001100110111110111000100111110111001101010001001111100000011111110110100101001000111000111000100101010110000001100001001000010111110010010011101110011110010111001000010010001111010000101010101011110100101011100111111100101101001000001101110011101101011001101011111011010001001000011010110101001000101011000110111011110101100110010011001100111100011011110100101001101101100010101101011101000111010000110000100101110000111101110000110001110000111100000010111100110000011011000000011000100011001000001011011111001010110101100100001010110100101100010111100111110000110000101010111010011101101000100010111010110100010000011000111010010101111111011111000011001011001000100100110111101000011001001011101000011110000010011100001100010111110110101110110100110010011111110110110100110001010000011111000001100010001110101110000000001111110110110111011110000001101010110110001111001010001110111110000011000110000011100111101001101011000011010001010110011000100111101000010101010010010110001111111100011100110111011011011010101001001011001111111000011101110010100111010100110000101100001011000001000100100111001001000010011101111111111011111100111101111001001100011001001100100110100100101001001000000101011011111110011010001101100111100010111100110111111010001110011000111011001010011110011011101010100110110111011110101111010001000110111001101010111111101010011110101001001101110010000001111100011010100110000001000011010111101111111000011110100011000011101011001000000100100111001100110011010010111010010111110111101111101010100000011101110001111101110111000111010110100000001010110001111101100000000111100111110111110001001101110111111001110111110101100101110010011000100001011010111100000101011100110101101001101000000101101101011001
``


Bulduğumuz `binary > decimal` olarak çevirince 

```
1785675652489484099866625219547495904829038087131470929199044461315809007854706383953994786918884048035991647560234437834959151802011378629807868402588942976844311309651656706051056662861977585604375693061105133360907548987191491448667845699504523835207433924461880683682959267121865752026017320250028695992655851462487112558508335629527434524159578362894834755516384098754276986466722254997719811154564444862004477733023964344810084134554812087896823698060594556299357881509322147331428184535043671737865691756584143724813124256017858804886372514187982328602595109583194368610294480604421697058921714316076575120217
```

Bu sayı ise Soru.txt de ki RSA problemini çözmek için kullanacağımız d sayısına eşit. d yi biliyorsak çok rahatça hesaplayabiliriz.

RSA scripti:

```python

n =  24554082244423576690279633247865769176171558470735704642013748456293986193768290232671815437132451174934519049784696027147781044695306925702057388654404061134243359186055889332417446146289789929503311347508856172482634852836123428376583619524965874497204667755767688503035506095489672593674965956038947918754161997820726040674864658744822975386315296832923061518481651545615396827420722325276534476848101960733475080768574205931138886447888957784368331413187068740663339419123762654261526051955619178483106487893708893917779677273100451964193513643587668371074516605372011468635189674135998949600383546855684675027489
c =  6989948518232384864776638814859831591901837611907564903634405279896177437836827945714748614888983988728637485614070870977180774832773899224982914219277551793975090942823743973796811784289974047801705426989528230917131553686987581588091533315187245746656484375900794753350613814764158557562323887200250573252180097909170473172195491291928129134980077422551100499336853912674636732929441216424149814296320827970989924149481811607226528197449647871111226798077417180876925544299697444446643855793213707552379877215861130808560692690231253480548958307798400899147718220394516058861876909981592273632212374753442396382822
d = 1785675652489484099866625219547495904829038087131470929199044461315809007854706383953994786918884048035991647560234437834959151802011378629807868402588942976844311309651656706051056662861977585604375693061105133360907548987191491448667845699504523835207433924461880683682959267121865752026017320250028695992655851462487112558508335629527434524159578362894834755516384098754276986466722254997719811154564444862004477733023964344810084134554812087896823698060594556299357881509322147331428184535043671737865691756584143724813124256017858804886372514187982328602595109583194368610294480604421697058921714316076575120217

# Decryption
m = pow(c,d,n)
print 'flag :', str(hex(int(m)))[2:-1].decode('hex')

```

FLAG: `STMCTF{guc_s3n1nl3_0lsun}`










